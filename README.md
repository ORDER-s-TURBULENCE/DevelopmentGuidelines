# 🌿 GitHub 運用ルール
created by ChatGPT

このリポジトリでは、
**安全でシンプルな2人チーム開発** を目的として、
`main` ブランチを中心に明確な運用ルールを定めています。

---

## 🔐 ブランチ保護ルール（main）

対象：

* `main`

### ❌ 禁止事項

* 直接の push
* `--force` push（強制 push）
* ブランチ削除

### ✅ プルリクエスト必須

* すべての変更は **Pull Request（PR）経由で main に統合**
* PR作成時は自動的にレビューが要求されます

---

## 🧾 レビュー・マージ条件

| 項目             | 内容                                  |
| -------------- | ----------------------------------- |
| **承認数**        | 最低 1 名の承認が必要                        |
| **コードオーナー承認**  | 対象ファイルが指定されている場合は必須                 |
| **未解決コメント**    | すべてのスレッドを解決しないとマージ不可                |
| **古いレビューはリセット**   | 新しい push をすると承認がリセットされる           |
| **自動レビュー**     | GitHub Copilotによる補助あり（任意）           |
| **マージ方法**      | `merge`, `squash`, `rebase` のいずれか許可 |

---

## 🧱 ブランチ戦略

### 🌱 基本構成

```
main              # 安定版ブランチ（レビュー済みのみマージ可）
└── feature/xxx   # 個人作業・機能開発用
```

### ブランチ作成ルール

* `main` から派生して作業ブランチを作成
* 名前は用途に応じて統一した形式で命名すること

| 種類     | プレフィックス     | 例                    |
| ------ | ----------- | -------------------- |
| 機能追加   | `feature/`  | `feature/login-ui`   |
| バグ修正   | `fix/`      | `fix/api-endpoint`   |
| リファクタ  | `refactor/` | `refactor/auth-flow` |
| ドキュメント | `docs/`     | `docs/update-readme` |
| テスト    | `test/`     | `test/user-service`  |

---

## 🧩 コミットメッセージ規約

可読性の高い履歴を維持するため、
**コミットメッセージは以下の形式**で記述します：

```
<type>: <短い説明>
```

### 使用可能なタイプ一覧

| タイプ          | 説明                  | 例                        |
| ------------ | ------------------- | ------------------------ |
| **feat**     | 新しい機能の追加            | `feat: ログインフォームを追加`      |
| **fix**      | 不具合の修正              | `fix: トークン検証の不具合を修正`     |
| **refactor** | 構造・リファクタリング         | `refactor: 認証ロジックを分離`    |
| **docs**     | ドキュメントの変更           | `docs: READMEに手順を追記`     |
| **style**    | コード整形・見た目修正（動作変更なし） | `style: インデントを修正`        |
| **test**     | テストの追加・修正           | `test: ログインAPIの単体テストを追加` |
| **chore**    | ビルド設定やCIなどの環境構成     | `chore: ESLintの設定を更新`    |

### 例

```bash
git commit -m "feat: ユーザ登録フォームを追加"
git commit -m "fix: パスワード入力時のバリデーションを修正"
```

---

## 🧭 開発フロー

1. **作業ブランチを作成**

   ```bash
   git checkout -b feature/your-feature
   ```

2. **作業・コミット・push**

   ```bash
   git add .
   git commit -m "feat: 機能を追加"
   git push origin feature/your-feature
   ```

3. **GitHubでPRを作成**

   * base: `main`
   * compare: `feature/your-feature`

4. **レビュー依頼**

   * 最低1名が承認すればマージ可能
   * コメントはすべて解決必須

5. **マージ方法**

   * 小規模変更 → **Squash Merge（推奨）**
   * 大きな変更や履歴保持 → **Merge Commit**

6. **作業ブランチ削除**

   ```bash
   git branch -d feature/your-feature
   git push origin --delete feature/your-feature
   ```

---

## 🧩 ステータスチェック（CIが導入された場合）

将来的にテストやLintなどの自動チェックを導入した場合、
PRマージ前に **「CIが成功していることを必須」** とすることを推奨します。

例：

* ✅ ESLint / Prettier チェック
* ✅ TypeScript ビルド確認
* ✅ Unit Test 成功

（GitHub設定 → Branch Protection → “Require status checks to pass before merging”）

---

## 🪄 推奨マージ戦略

| 方法               | 特徴           | 用途              | 推奨度   |
| ---------------- | ------------ | --------------- | ----- |
| **Squash Merge** | コミットを1つにまとめる | 小規模な機能・修正       | ⭐⭐⭐⭐⭐ |
| **Merge Commit** | 履歴を残して統合     | 大きな機能追加や長期開発    | ⭐⭐⭐⭐☆ |
| **Rebase Merge** | 履歴を直線的に整理    | 自分専用ブランチでのみ使用推奨 | ⭐⭐☆☆☆ |

---

## 📘 運用まとめ

| 項目           | 内容                                              |
| ------------ | ----------------------------------------------- |
| 保護対象ブランチ     | `main`                                          |
| 直接 push / 削除 | ❌ 禁止                                            |
| 承認必要数        | ✅ 1名以上                                          |
| コードオーナー承認    | 必須                                              |
| 未解決スレッド      | マージ不可                                           |
| 古い承認リセット     | 有効（再承認が必要）                                       |
| 自動レビュー       | 任意（Copilot有効）                                   |
| マージ方法        | Merge / Squash / Rebase                         |
| ブランチ命名       | feature/, fix/, refactor/, docs/, test/, chore/ |
| コミット形式       | `<type>: <説明>`                                  |

---

## 💬 2人チームでの運用例

| 開発者 | 作業内容                      | レビュー者 | 結果     |
| --- | ------------------------- | ----- | ------ |
| A   | `feature/login-ui` を作成・PR | B     | 承認→マージ |
| B   | `fix/api-endpoint` を修正・PR | A     | 承認→マージ |

このように**相互レビューで `main` を保護**することで、
小規模でも安定かつ継続的な開発が可能になります。

---

## 🏁 まとめ

このルールにより：

* main は常に **動作保証された安定ブランチ**
* feature ブランチでは **自由に実験・開発可能**
* コミット履歴とレビューが明確に管理される
